Error encountered while fetching public networks
Generating typings for: 1 artifacts in dir: typechain for target: ethers-v5
Successfully generated 5 typings!
Compiled 1 Solidity file successfully
 ·----------------------------------|-------------|---------------·
 |  Contract Name                   ·  Size (KB)  ·  Change (KB)  │
 ···································|·············|················
 |  AccountControl                  ·     20.913  ·               │
 ···································|·············|················
 |  Address                         ·      0.086  ·               │
 ···································|·············|················
 |  AddressUpgradeable              ·      0.086  ·               │
 ···································|·············|················
 |  Bank                            ·      6.738  ·               │
 ···································|·············|················
 |  BankStub                        ·      6.791  ·               │
 ···································|·············|················
 |  BitcoinAddressUtils             ·      0.086  ·               │
 ···································|·············|················
 |  BitcoinTx                       ·      0.086  ·               │
 ···································|·············|················
 |  BitcoinTx                       ·      0.086  ·               │
 ···································|·············|················
 |  Branch                          ·      0.086  ·               │
 ···································|·············|················
 |  Bridge                          ·     22.390  ·               │
 ···································|·············|················
 |  BridgeGovernance                ·     19.736  ·               │
 ···································|·············|················
 |  BridgeGovernanceParameters      ·     14.639  ·               │
 ···································|·············|················
 |  BridgeState                     ·      0.086  ·               │
 ···································|·············|················
 |  BTCDepositorWormhole            ·     11.005  ·               │
 ···································|·············|················
 |  BTCUtils                        ·      0.217  ·               │
 ···································|·············|················
 |  BytesLib                        ·      0.086  ·               │
 ···································|·············|················
 |  BytesLib                        ·      0.086  ·               │
 ···································|·············|················
 |  Chaosnet                        ·      1.564  ·               │
 ···································|·············|················
 |  CheckBitcoinSigs                ·      0.086  ·               │
 ···································|·············|················
 |  Constants                       ·      0.086  ·               │
 ···································|·············|················
 |  CountersUpgradeable             ·      0.086  ·               │
 ···································|·············|················
 |  CrosschainUtils                 ·      0.086  ·               │
 ···································|·············|················
 |  Deposit                         ·      6.894  ·               │
 ···································|·············|················
 |  DepositSweep                    ·     12.081  ·               │
 ···································|·············|················
 |  DonationVault                   ·      2.352  ·               │
 ···································|·············|················
 |  ECDSA                           ·      0.086  ·               │
 ···································|·············|················
 |  EcdsaAuthorization              ·      0.086  ·               │
 ···································|·············|················
 |  EcdsaDkg                        ·      0.135  ·               │
 ···································|·············|················
 |  EcdsaDkgValidator               ·      6.282  ·               │
 ···································|·············|················
 |  EcdsaInactivity                 ·      4.385  ·               │
 ···································|·············|················
 |  EcdsaLib                        ·      0.086  ·               │
 ···································|·············|················
 |  EcdsaLibStub                    ·      0.506  ·               │
 ···································|·············|················
 |  ECDSAUpgradeable                ·      0.086  ·               │
 ···································|·············|················
 |  ERC1967Proxy                    ·      0.751  ·               │
 ···································|·············|················
 |  ERC20                           ·      2.382  ·               │
 ···································|·············|················
 |  ERC20Upgradeable                ·      2.389  ·               │
 ···································|·············|················
 |  ERC20WithPermit                 ·      5.425  ·               │
 ···································|·············|················
 |  ERC721                          ·      5.008  ·               │
 ···································|·············|················
 |  Fraud                           ·      8.775  ·               │
 ···································|·············|················
 |  GovernanceUtils                 ·      0.086  ·               │
 ···································|·············|················
 |  Heartbeat                       ·      0.086  ·               │
 ···································|·············|················
 |  HeartbeatStub                   ·      0.435  ·               │
 ···································|·············|················
 |  IBridgeTypes                    ·      0.086  ·               │
 ···································|·············|················
 |  L1BTCDepositorWormhole          ·     12.632  ·               │
 ···································|·············|················
 |  L1BTCRedeemerWormhole           ·      7.852  ·               │
 ···································|·············|················
 |  L2BTCDepositorWormhole          ·      4.239  ·               │
 ···································|·············|················
 |  L2BTCRedeemerWormhole           ·      5.804  ·               │
 ···································|·············|················
 |  L2TBTC                          ·     11.232  ·               │
 ···································|·············|················
 |  L2WormholeGateway               ·      8.563  ·               │
 ···································|·············|················
 |  Leaf                            ·      0.086  ·               │
 ···································|·············|················
 |  LightRelay                      ·      8.336  ·               │
 ···································|·············|················
 |  LightRelayMaintainerProxy       ·      2.619  ·               │
 ···································|·············|················
 |  LightRelayStub                  ·      8.618  ·               │
 ···································|·············|················
 |  MaintainerProxy                 ·      8.813  ·               │
 ···································|·············|················
 |  MaliciousTBTC                   ·      5.238  ·               │
 ···································|·············|················
 |  Math                            ·      0.086  ·               │
 ···································|·············|················
 |  MathUpgradeable                 ·      0.086  ·               │
 ···································|·············|················
 |  MisfundRecovery                 ·      2.092  ·               │
 ···································|·············|················
 |  MockAccountControl              ·      3.934  ·               │
 ···································|·············|················
 |  MockBank                        ·      5.341  ·               │
 ···································|·············|················
 |  MockBankWithSeparatedOps        ·      4.767  ·        0.078  │
 ···································|·············|················
 |  MockBridge                      ·      5.481  ·               │
 ···································|·············|················
 |  MockBridgeForStarkNet           ·      3.563  ·               │
 ···································|·············|················
 |  MockL1BTCRedeemerWormhole       ·      6.935  ·               │
 ···································|·············|················
 |  MockQCData                      ·      1.946  ·               │
 ···································|·············|················
 |  MockQCManager                   ·      1.620  ·               │
 ···································|·············|················
 |  MockReimbursementPool           ·      0.895  ·               │
 ···································|·············|················
 |  MockReserve                     ·      4.987  ·               │
 ···································|·············|················
 |  MockReserveOracle               ·      0.934  ·               │
 ···································|·············|················
 |  MockStarkGateBridge             ·      3.384  ·               │
 ···································|·············|················
 |  MockSystemState                 ·      0.971  ·               │
 ···································|·············|················
 |  MockTBTCBridge                  ·      3.426  ·               │
 ···································|·············|················
 |  MockTBTCBridgeWithSweep         ·      2.994  ·               │
 ···································|·············|················
 |  MockTBTCToken                   ·      3.216  ·               │
 ···································|·············|················
 |  MockTBTCVault                   ·      1.042  ·               │
 ···································|·············|················
 |  MockTBTCVault                   ·      1.529  ·               │
 ···································|·············|················
 |  MovingFunds                     ·     20.473  ·               │
 ···································|·············|················
 |  OutboundTx                      ·      0.086  ·               │
 ···································|·············|················
 |  Position                        ·      0.086  ·               │
 ···································|·············|················
 |  ProxyAdmin                      ·      1.881  ·               │
 ···································|·············|················
 |  QCData                          ·      9.241  ·               │
 ···································|·············|················
 |  QCManager                       ·     23.829  ·               │
 ···································|·············|················
 |  QCManagerLib                    ·     12.008  ·               │
 ···································|·············|················
 |  QCManagerPauseLib               ·      4.110  ·               │
 ···································|·············|················
 |  QCMinter                        ·     13.678  ·               │
 ···································|·············|················
 |  QCRedeemer                      ·     21.324  ·               │
 ···································|·············|················
 |  QCRedeemerSPV                   ·      5.109  ·               │
 ···································|·············|················
 |  QCRedeemerSPVTest               ·      8.209  ·               │
 ···································|·············|················
 |  QCRedeemerSPVTestUninitialized  ·      0.963  ·               │
 ···································|·············|················
 |  ReceiveApprovalStub             ·      0.728  ·               │
 ···································|·············|················
 |  Redemption                      ·     17.708  ·               │
 ···································|·············|················
 |  RedemptionWatchtower            ·      9.612  ·               │
 ···································|·············|················
 |  ReimbursementPool               ·      2.610  ·               │
 ···································|·············|················
 |  RelayUtils                      ·      0.086  ·               │
 ···································|·············|················
 |  ReserveOracle                   ·      8.768  ·               │
 ···································|·············|················
 |  Rewards                         ·      0.155  ·               │
 ···································|·············|················
 |  RNG                             ·      0.086  ·               │
 ···································|·············|················
 |  SafeCastUpgradeable             ·      0.086  ·               │
 ···································|·············|················
 |  SafeERC20                       ·      0.086  ·               │
 ···································|·············|················
 |  SafeERC20Upgradeable            ·      0.086  ·               │
 ···································|·············|················
 |  SafeMath                        ·      0.086  ·               │
 ···································|·············|················
 |  SepoliaLightRelay               ·      8.405  ·               │
 ···································|·············|················
 |  SharedSPVCore                   ·     10.857  ·               │
 ···································|·············|················
 |  SortitionPool                   ·     11.652  ·               │
 ···································|·············|················
 |  SortitionTree                   ·      1.236  ·               │
 ···································|·············|················
 |  SPVState                        ·      0.086  ·               │
 ···································|·············|················
 |  StarkNetBitcoinDepositor        ·     10.569  ·               │
 ···································|·············|················
 |  StorageSlot                     ·      0.086  ·               │
 ···································|·············|················
 |  StorageSlotUpgradeable          ·      0.086  ·               │
 ···································|·············|················
 |  Strings                         ·      0.086  ·               │
 ···································|·············|················
 |  StringsUpgradeable              ·      0.086  ·               │
 ···································|·············|················
 |  SystemState                     ·      8.772  ·               │
 ···································|·············|················
 |  SystemTestRelay                 ·      1.199  ·               │
 ···································|·············|················
 |  TBTC                            ·      6.753  ·               │
 ···································|·············|················
 |  TBTCVault                       ·     14.126  ·               │
 ···································|·············|················
 |  TestBitcoinAddressUtils         ·      5.411  ·               │
 ···································|·············|················
 |  TestBitcoinTx                   ·      5.550  ·               │
 ···································|·············|················
 |  TestBTCDepositor                ·      4.537  ·               │
 ···································|·············|················
 |  TestBTCRedeemer                 ·      5.133  ·               │
 ···································|·············|················
 |  TestBTCUtilsHelper              ·      1.607  ·               │
 ···································|·············|················
 |  TestEcdsaLib                    ·      0.506  ·               │
 ···································|·············|················
 |  TestEmergencyIntegration        ·      1.744  ·               │
 ···································|·············|················
 |  TestERC20                       ·      5.567  ·               │
 ···································|·············|················
 |  TestERC721                      ·      5.612  ·               │
 ···································|·············|················
 |  TestRelay                       ·      1.261  ·               │
 ···································|·············|················
 |  Timelock                        ·      8.414  ·               │
 ···································|·············|················
 |  TimelockController              ·      8.414  ·               │
 ···································|·············|················
 |  TransparentUpgradeableProxy     ·      2.202  ·               │
 ···································|·············|················
 |  ValidateSPV                     ·      0.086  ·               │
 ···································|·············|················
 |  VendingMachine                  ·      5.747  ·               │
 ···································|·············|················
 |  VendingMachineV2                ·      3.150  ·               │
 ···································|·············|················
 |  VendingMachineV3                ·      3.966  ·               │
 ···································|·············|················
 |  WalletProposalValidator         ·     15.332  ·               │
 ···································|·············|················
 |  Wallets                         ·      0.086  ·               │
 ···································|·············|················
 |  Wallets                         ·      3.998  ·               │
 ···································|·············|················
 |  WatchdogEnforcer                ·      7.737  ·               │
 ···································|·············|················
 |  WormholeTypes                   ·      0.086  ·               │
 ···································|·············|················
 |  WormholeUtils                   ·      0.086  ·               │
 ·----------------------------------|-------------|---------------·

  MockReserve - AccountControl Direct Backing Integration
Warning: A proxy admin was previously deployed on this network

    This is not natively used with the current kind of proxy ('uups').
    Changes to the admin will have no effect on this new proxy.

    1. Reserve Authorization & Setup
      ✓ should authorize MOCK_RESERVE with minting cap
      ✓ should initialize with zero backing and zero minted
      ✓ should assign correct minting cap
      ✓ should emit ReserveAuthorized event
    2. Direct Backing Management (Federated Model)
      ✓ should allow reserve to update its own backing
      ✓ should emit BackingUpdated event with old and new values
      ✓ should allow backing increases and decreases
      ✓ should handle zero backing scenarios
      ✓ should track backing history for transparency
    3. Minting Operations via Bank Integration
      ✓ should mint through Bank.increaseBalance() chain
      ✓ should enforce backing >= minted + amount invariant
      ✓ should support minting to different target addresses
      ✓ should update both reserve minted and total minted
      ✓ should revert on insufficient backing
      ✓ should emit MintExecuted event
    4. Batch Minting Optimization
      ✓ should process batch mints in single transaction
      ✓ should validate total amount against backing once
      ✓ should achieve gas savings for multiple operations
      ✓ should maintain atomicity (all succeed or all fail)
    5. Redemption Flows
      ✓ should decrease minted amount on redemption
      ✓ should allow partial redemptions
      ✓ should emit RedemptionProcessed event
      ✓ should revert if redeeming more than minted
      ✓ should pause both minting and redemption when reserve paused
    6. Core Invariant Enforcement
      ✓ should never allow minted > backing
      ✓ should track individual reserve solvency
      ✓ should prevent cross-reserve subsidization
      ✓ should enforce MIN_MINT_AMOUNT
      ✓ should enforce MAX_SINGLE_MINT
    7. Pause Mechanisms
      ✓ should pause both minting and redemption when reserve paused
      ✓ should pause all operations (emergency)
      ✓ should pause specific reserve without affecting others
      ✓ should auto-recover from pause when conditions met
      ✓ should emit appropriate pause/unpause events
    8. Reserve Deauthorization
      ✓ should prevent deauthorization with outstanding minted balance
      ✓ should clear backing when deauthorizing clean reserve
      ✓ should emit ReserveDeauthorized event
      ✓ should prevent operations after deauthorization
    9. Multi-Reserve Scenarios
      ✓ should maintain isolation between multiple MockReserves
      ✓ should track totalMinted across all reserves
      ✓ should allow different backing strategies per reserve
      ✓ should handle concurrent operations from different reserves
    10. Edge Cases & Failure Modes
      ✓ should handle rapid backing updates
      ✓ should have reentrancy protection in AccountControl
      ✓ should handle large uint values correctly
      ✓ should recover from temporary insolvency
      ✓ should handle simulation failures gracefully
      ✓ should handle zero address checks
      ✓ should validate array length mismatches
    Integration with AccountControl Events
      ✓ should emit all expected events in correct order
    Gas Optimization Verification

    Gas Optimization Results:
      Single operation gas: 139040
      Batch operation gas: 1210563
      Gas per operation (batch): 60528
      Estimated individual total: 2780800
      Actual savings: 1570237 gas (56%)
      ✓ should demonstrate gas savings with batch operations

·--------------------------------------------------|---------------------------|--------------|-----------------------------·
|               [90mSolc version: 0.8.17[39m               ·  [90mOptimizer enabled: true[39m  ·  [90mRuns: 1000[39m  ·  [90mBlock limit: 30000000 gas[39m  │
···················································|···························|··············|······························
|  [32m[1mMethods[22m[39m                                                                                                                  │
····················|······························|·············|·············|··············|···············|··············
|  [1mContract[22m         ·  [1mMethod[22m                      ·  [32mMin[39m        ·  [32mMax[39m        ·  [32mAvg[39m         ·  [1m# calls[22m      ·  [1meur (avg)[22m  │
····················|······························|·············|·············|··············|···············|··············
|  [90mAccountControl[39m   ·  authorizeReserve            ·     [36m149220[39m  ·     [31m166344[39m  ·      149812  ·           [90m60[39m  ·          [32m[90m-[32m[39m  │
····················|······························|·············|·············|··············|···············|··············
|  [90mAccountControl[39m   ·  deauthorizeReserve          ·     [36m137506[39m  ·     [31m137518[39m  ·      137515  ·            [90m4[39m  ·          [32m[90m-[32m[39m  │
····················|······························|·············|·············|··············|···············|··············
|  [90mAccountControl[39m   ·  pauseReserve                ·      [36m35144[39m  ·      [31m35168[39m  ·       35164  ·            [90m6[39m  ·          [32m[90m-[32m[39m  │
····················|······························|·············|·············|··············|···············|··············
|  [90mAccountControl[39m   ·  pauseSystem                 ·          -  ·          -  ·       34267  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
····················|······························|·············|·············|··············|···············|··············
|  [90mAccountControl[39m   ·  unpauseReserve              ·          -  ·          -  ·       35114  ·            [90m3[39m  ·          [32m[90m-[32m[39m  │
····················|······························|·············|·············|··············|···············|··············
|  [90mAccountControl[39m   ·  unpauseSystem               ·          -  ·          -  ·       34162  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
····················|······························|·············|·············|··············|···············|··············
|  [90mMockBank[39m         ·  authorizeBalanceIncreaser   ·          -  ·          -  ·       46116  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
····················|······························|·············|·············|··············|···············|··············
|  [90mMockReserve[39m      ·  batchMint                   ·     [36m232895[39m  ·    [31m1210563[39m  ·      703019  ·            [90m6[39m  ·          [32m[90m-[32m[39m  │
····················|······························|·············|·············|··············|···············|··············
|  [90mMockReserve[39m      ·  increaseBacking             ·      [36m60850[39m  ·      [31m60862[39m  ·       60852  ·            [90m6[39m  ·          [32m[90m-[32m[39m  │
····················|······························|·············|·············|··············|···············|··············
|  [90mMockReserve[39m      ·  mintTokens                  ·     [36m121940[39m  ·     [31m241652[39m  ·      149866  ·           [90m49[39m  ·          [32m[90m-[32m[39m  │
····················|······························|·············|·············|··············|···············|··············
|  [90mMockReserve[39m      ·  redeemTokens                ·      [36m57978[39m  ·      [31m62790[39m  ·       62189  ·            [90m8[39m  ·          [32m[90m-[32m[39m  │
····················|······························|·············|·············|··············|···············|··············
|  [90mMockReserve[39m      ·  setBacking                  ·      [36m51003[39m  ·     [31m111975[39m  ·       84365  ·          [90m117[39m  ·          [32m[90m-[32m[39m  │
····················|······························|·············|·············|··············|···············|··············
|  [90mMockReserve[39m      ·  simulateFailure             ·      [36m23925[39m  ·      [31m45837[39m  ·       34881  ·            [90m2[39m  ·          [32m[90m-[32m[39m  │
····················|······························|·············|·············|··············|···············|··············
|  [32m[1mDeployments[22m[39m                                     ·                                          ·  [1m% of limit[22m   ·             │
···················································|·············|·············|··············|···············|··············
|  AccountControl                                  ·          -  ·          -  ·     4587700  ·       [90m15.3 %[39m  ·          [32m[90m-[32m[39m  │
···················································|·············|·············|··············|···············|··············
|  contracts/test/MockTBTCVault.sol:MockTBTCVault  ·          -  ·          -  ·      428440  ·        [90m1.4 %[39m  ·          [32m[90m-[32m[39m  │
···················································|·············|·············|··············|···············|··············
|  MockBank                                        ·          -  ·          -  ·     1260620  ·        [90m4.2 %[39m  ·          [32m[90m-[32m[39m  │
···················································|·············|·············|··············|···············|··············
|  MockReserve                                     ·          -  ·          -  ·     1153256  ·        [90m3.8 %[39m  ·          [32m[90m-[32m[39m  │
···················································|·············|·············|··············|···············|··············
|  MockTBTCToken                                   ·          -  ·          -  ·      847832  ·        [90m2.8 %[39m  ·          [32m[90m-[32m[39m  │
·--------------------------------------------------|-------------|-------------|--------------|---------------|-------------·

  51 passing (14s)

